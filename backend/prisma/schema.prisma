generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model linha {
  id             Int      @id @default(autoincrement())
  localsaida     String   @db.VarChar(255)
  localdestino   String   @db.VarChar(255)
  horariosaida   DateTime @db.DateTime(0)
  horariochegada DateTime @db.DateTime(0)
  nome           String   @db.VarChar(80)
  viagem         viagem[]
}

model motorista {
  id         Int      @id @default(autoincrement())
  nome       String   @db.VarChar(255)
  nascimento DateTime @db.Date
  sexo       String?  @db.Char(1)
  foto       String?  @db.VarChar(250)
  admissao   DateTime @db.Date
  viagem     viagem[]
}

model onibus {
  id     Int      @id @default(autoincrement())
  placa  String   @db.VarChar(8)
  viagem viagem[]
}

model passageiro {
  id         Int       @id @default(autoincrement())
  cpf        String    @unique @db.Char(11)
  nome       String    @db.VarChar(100)
  nascimento DateTime  @db.Date
  sexo       String?   @db.Char(1)
  email      String    @db.VarChar(250)
  telefone   String    @db.VarChar(20)
  endereco   String?   @db.VarChar(45)
  cidade     String    @db.VarChar(45)
  estado     String    @db.Char(2)
  saldo      Decimal   @db.Decimal(6, 2)
  recargas   recarga[]
}

model recarga {
  id            Int         @id @default(autoincrement())
  valor         Float
  data          DateTime
  passageiro_id Int?
  passageiro    passageiro? @relation(fields: [passageiro_id], references: [id], onUpdate: SetNull, map: "fk_recarga_passageiro1")

  @@index([passageiro_id], map: "fk_recarga_passageiro1")
}

model viagem {
  id           Int        @id @default(autoincrement())
  datahora     DateTime   @db.DateTime(0)
  linha_id     Int?
  motorista_id Int?
  onibus_id    Int?
  linha        linha?     @relation(fields: [linha_id], references: [id], onUpdate: SetNull, map: "fk_viagem_linha1")
  motorista    motorista? @relation(fields: [motorista_id], references: [id], onUpdate: SetNull, map: "fk_viagem_motorista1")
  onibus       onibus?    @relation(fields: [onibus_id], references: [id], onUpdate: SetNull, map: "fk_viagem_onibus1")

  @@index([linha_id], map: "fk_viagem_linha1_idx")
  @@index([motorista_id], map: "fk_viagem_motorista1_idx")
  @@index([onibus_id], map: "fk_viagem_onibus1_idx")
}
